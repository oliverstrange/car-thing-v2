import { VerticalBox } from "std-widgets.slint";
import { MenuItem } from "../components/MenuItem.slint";

export component MainMenu {
    width: 240px;
    height: 240px;
    in-out property <int> selected_index: 0;
    in property <bool> dark_mode: true;
    property <[{id: int, name: string}]> menu_items: [
        { id: 0, name: "Oil Temperature" },
        { id: 1, name: "Oil Pressure" },
        { id: 2, name: "Lap Timer" },
        { id: 3, name: "Settings" }
    ];
    callback move_up();
    callback move_down();
    callback enter();
    callback item_selected(int); // Callback to notify parent of selected screen
    move_up() => {
        if (selected_index > 0) {
            selected_index -= 1;
        }
    }
    move_down() => {
        if (selected_index < menu_items.length - 1) {
            selected_index += 1;
        }
    }
    enter() => {
        // Notify parent to change to the selected screen (index + 1 because menu is screen 0)
        item_selected(selected_index + 1);
    }
    VerticalBox {
        spacing: 25px;
        y: (self.height / 2) - (55 / 2) * 1px - (selected_index * 55) * 1px;
        animate y {
            duration: 300ms;
            easing: ease-in-out;
        }
        for item in root.menu_items: MenuItem {
            text: item.name;
            selected: selected_index == item.id;
            dark_mode: root.dark_mode;
        }
    }
}
